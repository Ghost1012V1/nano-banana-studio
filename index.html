
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nano Banana Studio</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel for in-browser JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.sh/@google/genai@1.3.0",
        "react": "https://esm.sh/react@19.0.0",
        "react-dom": "https://esm.sh/react-dom@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client"
      }
    }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background-color: #0f172a; color: #f8fafc; margin: 0; padding: 0; font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; }
        #root { height: 100vh; width: 100vw; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useRef, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { GoogleGenAI } from "@google/genai";

        const Icons = {
          Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z" /></svg>,
          Sun: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M3 12h2.25m.386-6.364l1.591 1.591M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg>,
          Moon: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M21.75 12.845a9.933 9.933 0 01-4.087 1.258 9.75 9.75 0 01-14.748-9.923 9.967 9.967 0 001.558 4.59 9.75 9.75 0 0013.277 4.075z" /></svg>,
          Photo: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-24 h-24"><path strokeLinecap="round" strokeLinejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>
        };

        const App = () => {
          const [isDarkMode, setIsDarkMode] = useState(true);
          const [prompt, setPrompt] = useState('Ein kleiner Affe mit einer Banane im Weltraum');
          const [image, setImage] = useState(null);
          const [loading, setLoading] = useState(false);
          const [aspectRatio, setAspectRatio] = useState('1:1');
          
          const [brightness, setBrightness] = useState(100);
          const [contrast, setContrast] = useState(100);
          const [saturation, setSaturation] = useState(100);
          const imageRef = useRef(null);

          const generateImage = async () => {
            const apiKey = "process.env.API_KEY"; // Placeholder for auto-injection
            if (!prompt.trim() || loading) return;
            setLoading(true);
            try {
              const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
              const response = await ai.models.generateContent({
                model: 'gemini-2.5-flash-image',
                contents: { parts: [{ text: prompt }] },
                config: { imageConfig: { aspectRatio } }
              });
              const part = response.candidates?.[0]?.content?.parts.find(p => p.inlineData);
              if (part?.inlineData) setImage(`data:image/png;base64,${part.inlineData.data}`);
            } catch (e) { alert("Fehler: " + e.message); }
            finally { setLoading(false); }
          };

          const handleDownload = () => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = imageRef.current.naturalWidth;
            canvas.height = imageRef.current.naturalHeight;
            ctx.filter = `brightness(${brightness}%) contrast(${contrast}%) saturate(${saturation}%)`;
            ctx.drawImage(imageRef.current, 0, 0);
            const link = document.createElement('a');
            link.download = 'nano-banana.png';
            link.href = canvas.toDataURL();
            link.click();
          };

          return (
            <div className={`h-screen flex flex-col md:flex-row ${isDarkMode ? 'bg-[#0f172a] text-slate-100' : 'bg-slate-50 text-slate-900'}`}>
              <aside className="w-full md:w-80 glass p-6 flex flex-col space-y-6 border-r border-slate-800">
                <div className="flex justify-between items-center">
                  <div className="flex items-center space-x-2 text-yellow-400 font-black"><Icons.Sparkles /> <span>NANO BANANA</span></div>
                  <button onClick={() => setIsDarkMode(!isDarkMode)} className="p-2 rounded bg-slate-800 text-yellow-400">
                    {isDarkMode ? <Icons.Sun /> : <Icons.Moon />}
                  </button>
                </div>
                <textarea value={prompt} onChange={e => setPrompt(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl p-3 text-sm min-h-[100px] outline-none focus:ring-2 focus:ring-yellow-400" />
                <select value={aspectRatio} onChange={e => setAspectRatio(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded-xl p-3 text-sm">
                  <option value="1:1">1:1 Quadrat</option>
                  <option value="16:9">16:9 Breitbild</option>
                  <option value="9:16">9:16 Portrait</option>
                </select>
                <button onClick={generateImage} disabled={loading} className="w-full py-4 bg-yellow-400 text-slate-950 rounded-xl font-black disabled:opacity-50">
                  {loading ? "MALT..." : "BILD GENERIEREN"}
                </button>
              </aside>
              <main className="flex-1 p-6 flex items-center justify-center relative">
                <div className="w-full max-w-2xl text-center">
                  <div className="glass rounded-3xl min-h-[300px] flex items-center justify-center overflow-hidden">
                    {loading ? <div className="text-yellow-400 font-black animate-pulse">GENERIERUNG...</div> : 
                     image ? <img ref={imageRef} src={image} style={{filter: `brightness(${brightness}%) contrast(${contrast}%) saturate(${saturation}%)`}} className="max-w-full max-h-[70vh] shadow-2xl" /> : 
                     <div className="opacity-20"><Icons.Photo /></div>}
                  </div>
                  {image && !loading && (
                    <div className="mt-4 p-4 glass rounded-xl space-y-4">
                      <div className="grid grid-cols-3 gap-2 text-[10px] font-bold">
                        <div>Hell: <input type="range" min="50" max="150" value={brightness} onChange={e=>setBrightness(e.target.value)} className="w-full accent-yellow-400" /></div>
                        <div>Kontr: <input type="range" min="50" max="150" value={contrast} onChange={e=>setContrast(e.target.value)} className="w-full accent-yellow-400" /></div>
                        <div>SÃ¤tt: <input type="range" min="0" max="200" value={saturation} onChange={e=>setSaturation(e.target.value)} className="w-full accent-yellow-400" /></div>
                      </div>
                      <button onClick={handleDownload} className="w-full py-2 bg-emerald-500 text-slate-950 font-black rounded-lg text-xs">BILD SPEICHERN</button>
                    </div>
                  )}
                </div>
              </main>
            </div>
          );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
